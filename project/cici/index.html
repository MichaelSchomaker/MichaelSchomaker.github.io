<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Causal Inference for Continuous Interventions">

  
  <link rel="alternate" hreflang="en-us" href="https://MichaelSchomaker.github.io/project/cici/">

  


  
  
  
  <meta name="theme-color" content="#7a2740">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=G-1H96H2N17D"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-1H96H2N17D', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hue888863bcf6448bbe1c2d7b1880687e8_12435_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hue888863bcf6448bbe1c2d7b1880687e8_12435_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://MichaelSchomaker.github.io/project/cici/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@mf_schomaker">
  <meta property="twitter:creator" content="@mf_schomaker">
  
  <meta property="og:site_name" content="Michael Schomaker">
  <meta property="og:url" content="https://MichaelSchomaker.github.io/project/cici/">
  <meta property="og:title" content="CICI | Michael Schomaker">
  <meta property="og:description" content="Causal Inference for Continuous Interventions"><meta property="og:image" content="https://MichaelSchomaker.github.io/project/cici/featured.jpeg">
  <meta property="twitter:image" content="https://MichaelSchomaker.github.io/project/cici/featured.jpeg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2023-01-04T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2023-01-04T00:00:00&#43;00:00">
  

  


    









<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://MichaelSchomaker.github.io/project/cici/"
  },
  "headline": "CICI",
  
  "image": [
    "https://MichaelSchomaker.github.io/project/cici/featured.jpeg"
  ],
  
  "datePublished": "2023-01-04T00:00:00Z",
  "dateModified": "2023-01-04T00:00:00Z",
  
  "publisher": {
    "@type": "Organization",
    "name": "Michael Schomaker",
    "logo": {
      "@type": "ImageObject",
      "url": "https://MichaelSchomaker.github.io/images/icon_hue888863bcf6448bbe1c2d7b1880687e8_12435_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "Causal Inference for Continuous Interventions"
}
</script>

  

  


  


  





  <title>CICI | Michael Schomaker</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Michael Schomaker</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Michael Schomaker</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-center" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/featured/"><span>Research</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/software/"><span>Software & Code</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/teaching/"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/book/"><span>Book</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/contact/"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article article-project">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>CICI</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Jan 4, 2023
  </span>
  

  

  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <p><strong>CICI</strong> is an 
  <i class="fab fa-r-project  pr-1 fa-fw"></i> package for <strong>C</strong>ausal <strong>I</strong>nference with <strong>C</strong>ontinuous <strong>I</strong>nterventions.</p>
<p>It facilitates estimation of counterfactual outcomes for multiple values of continuous interventions at different time points, and allows plotting of causal dose-response curves (CDRC). It can address positivity violations through weight functions.</p>
<p>The package implements the methods described in Schomaker, McIlleron, Denti and Díaz (2023), see  
<a href="https://MichaelSchomaker.github.io/publication/2023-05-12_continuous_intervention/">here</a>. It can be used for non-continuous interventions too. Briefly, the paper describes two approaches: the first one is to use 
standard parametric $g$-computation, where one intervenes on multiple values of the continuous intervention, at each time point. This approach may be complemented with diagnostics to understand the severity of positivity violations. An alternative approach 
is to use sequential $g$-computation where outcome weights redefine the estimand in regions of low support. Note that developing $g-$formula-based approaches for continuous longitudinal interventions is an obvious suggestion because developing a standard doubly robust estimator, e.g.
a TMLE, is not possible as the CDRC is not a pathwise-differentiable parameter; and developing non-standard doubly robust estimators is not straightforward in a multiple time-point setting.</p>
<p>
<a href="#gformula">$\rightarrow$ standard parametric $g$-formula</a></p>
<p>
<a href="#sgf">$\rightarrow$ weighted sequential $g$-formula</a></p>
<p>
<a href="#code">$\rightarrow$ example code</a></p>
<h3 id="installation">Installation</h3>
<p>The package is available on CRAN. The weighted sequential approach is currently only available on GitHub and needs to be installed seperately, but will be integrated into the main package later:</p>
<pre><code class="language-{r}">install.packages(&quot;CICI&quot;)
library(remotes)
remotes::install_github(&quot;MichaelSchomaker/CICIplus&quot;)
</code></pre>
<p><a name="gformula"></a></p>
<h3 id="standard-g-computation-for-continuous-interventions">Standard $g$-computation for continuous interventions</h3>
<h4 id="standard-application">Standard application</h4>
<p>As an example, consider the efavirenz data contained in the package. This simulated data set is similar to the real data set described in Schomaker et al. (2023; see paper on more details, including identification considerations). We are interested in what the probability of viral failure (binary outcome) at time $t$ would be
if the concentration was $a$ mg/l for everyone ($a=0,&hellip;,10$), at each time point. If the intervention values do not change over time, we can simply specify a vector under $\texttt{abar}$ that contains the values with which we 
want to intervene. Apart from this, only the dataset ($\texttt{X}$), time-varying confounders ($\texttt{Lnodes}$), outcome variables ($\texttt{Ynodes}$) and intervention variables ($\texttt{Anodes}$) need to be specifed. Baseline variables are detected
automatically:</p>
<pre><code class="language-{r}">library(CICI)
data(EFV)

# parametric g-formula
est &lt;- gformula(X=EFV,
                Lnodes  = c(&quot;adherence.1&quot;,&quot;weight.1&quot;,
                            &quot;adherence.2&quot;,&quot;weight.2&quot;,
                            &quot;adherence.3&quot;,&quot;weight.3&quot;,
                            &quot;adherence.4&quot;,&quot;weight.4&quot;),
                Ynodes  = c(&quot;VL.0&quot;,&quot;VL.1&quot;,&quot;VL.2&quot;,&quot;VL.3&quot;,&quot;VL.4&quot;),
                Anodes  = c(&quot;efv.0&quot;,&quot;efv.1&quot;,&quot;efv.2&quot;,&quot;efv.3&quot;,&quot;efv.4&quot;),
                abar=seq(0,10,1)
)

est        # print estimates
plot(est)  # plot estimates
</code></pre>
<p>The $\texttt{plot}$ functionality can be used to plot the estimated counterfactual outcomes in terms of dose-response curves at different time points. In the below example, the curve at $t=5$ means that we look at $Y_5 = \text{VL}.4$ under the interventions 
$(0,0,0,0,0),&hellip;,(10,10,10,10,10)$:</p>
<div><img src="/img/CDRC_1.jpeg", width=100%></div>
<p>More complex custom interventions that change over time can be specified too under $\texttt{abar}$, and they will be plotted differently; type $\texttt{?gformula}$ for details.</p>
<h4 id="bootstrap-confidence-intervals">Bootstrap confidence intervals</h4>
<p>To obtain bootstrap confidence intervals, simply specify the number of bootstrap samples in the option $\texttt{B}$. CI&rsquo;s can also be plotted. Examples are given in the example code listed

<a href="#code">further below</a> (parallelization using the option $\texttt{ncores}$ is recommended).</p>
<h4 id="other-estimands">Other estimands</h4>
<p>In $\texttt{CICI}$, it is easy to estimate and plot other estimands than $E(Y^{abar})$. Simply, i) set the option $\texttt{ret=T}$ in $\texttt{gformula()}$, which saves the counterfactual datasets under the different interventions; and then, ii) apply the integrated $\texttt{custom.measure}$ function:</p>
<pre><code class="language-{r}">custom.measure(est, fun=prop, categ=1) # P(Y^a=1) - &gt; identical results
custom.measure(est, fun=prop, categ=0) # P(Y^a=0)
custom.measure(est, fun=prop, categ=0, cond=&quot;sex==1&quot;) # conditional on sex=1

# does not make sense here, just for illustration:
custom.measure(est, fun=quantile, probs=0.1) # counterfactual quantiles
</code></pre>
<h4 id="model-specification">Model specification</h4>
<p>The longitudinal parametric $g$-formula requires fitting of both confounder and outcome models at each time point. By default (as a starting point) GLM&rsquo;s with all variables included are used, though CICI is implemented in a more general and flexible GAM framework. The model
families are picked by $\texttt{CICI}$ automatically and are restricted to those available within the $\texttt{mgcv}$ package to fit generalized additive models. As correct model specification is imperative for the success of $g$-formula type of approaches, variable screening and the inclusion of non-linear and interaction terms is often important. The package comes with built-in wrappers to 
help with this. A recommended approach is to start as follows: 1) generate (strings of) all relevant model formulae with the function $\texttt{make.model.formulas}$, then 2) screen variables with LASSO using $\texttt{model.formulas.update}$ and
then 3) pass on the updated formulae (possibly aftr furthr manual updates, see below) to $\texttt{gformula}$ using the $\texttt{Yform, Lform, Aform, Cform}$ options, as required by the estimand.</p>
<pre><code class="language-{r}"># 1) Generic model formulas
m &lt;- make.model.formulas(X=EFV,
                         Lnodes  = c(&quot;adherence.1&quot;,&quot;weight.1&quot;,
                                     &quot;adherence.2&quot;,&quot;weight.2&quot;,
                                     &quot;adherence.3&quot;,&quot;weight.3&quot;,
                                     &quot;adherence.4&quot;,&quot;weight.4&quot;),
                         Ynodes  = c(&quot;VL.0&quot;,&quot;VL.1&quot;,&quot;VL.2&quot;,&quot;VL.3&quot;,&quot;VL.4&quot;),
                         Anodes  = c(&quot;efv.0&quot;,&quot;efv.1&quot;,&quot;efv.2&quot;,&quot;efv.3&quot;,&quot;efv.4&quot;)
)
m$model.names # all models potentially relevant for gformula(), given *full* past

# 2) Update model formulas (automated): screening with LASSO 
glmnet.formulas &lt;-  model.formulas.update(m$model.names, EFV)

# 3) use these models in gformula()
est &lt;- gformula(...,
                Yform=glmnet.formulas$Ynames, Lform=glmnet.formulas$Lnames,
                ...)
</code></pre>
<p>Obviously, even with this approach one may have to still manually improve the models, for example by adding (penalized) splines and interactions. Examples are given at the bottom of the following help pages:
$\texttt{?fit.updated.formulas, ?model.update}$. A future manual will give more details on possibilities of model specification.</p>
<h4 id="multiple-imputation">Multiple imputation</h4>
<p>CICI can deal with multiply imputed data. Currently the option MI Boot, explained in the publication 
<a href="#bottom">further below</a> (Schomaker and Heumann, 2018), is implemented. Simply use $\texttt{gformula}$ on each imputed data set and then use the 
$\texttt{mi.boot}$ command (custom estimands are possible too after imputation):</p>
<pre><code class="language-{r}"># suppose the following subsets were actually multiply imputed data (M=2)
EFV_1 &lt;- EFV[1:2500,]
EFV_2 &lt;- EFV[2501:5000,]

# first: conduct analysis on each imputed data set. Set ret=T.
m1 &lt;- gformula(..., ret=T)
m2 &lt;- gformula(..., ret=T)

# second: combine results
m_imp &lt;- mi.boot(list(m1,m2), mean) # uses MI rules &amp; returns 'gformula' object
plot(m_imp)

# custom estimand: evaluate probability of suppression (Y=0), among females
m_imp2 &lt;- mi.boot(list(m1,m2), prop, categ=0, cond=&quot;sex==1&quot;)
</code></pre>
<h4 id="other-useful-options">Other useful options</h4>
<p>There are many more useful option, wich are explained in $\texttt{?gformula}$:</p>
<ul>
<li>How to handle <strong>survival</strong> settings</li>
<li>How to generate diagnostics</li>
<li>How to specify both custom and natural interventions</li>
<li><strong>Parallelization</strong> using the option $\texttt{ncores}$ (very easy!)</li>
<li>How to track <strong>progress</strong>, even under parallelizations with $\texttt{prog}$</li>
<li>How to reproduce results using $\texttt{seed}$</li>
</ul>
<p>The package can of course also handle binary and categorical interventions. Dynamic interventions are not supported.</p>
<p><a name="sgf"></a></p>
<h3 id="weighted-sequential-g-computation">Weighted sequential $g$-computation</h3>
<h4 id="basic-unweighted-setup">Basic (unweighted) setup</h4>
<p>The function $\texttt{sgf()}$ implements the sequential $g$-formula and works very similar as $\texttt{gformula()}$. The below example illustrates this. The estimated CDRC&rsquo;s are very similar.</p>
<pre><code class="language-{r}">library(CICIplus) 

# (unweighted) sequential g-formula
est2 &lt;- sgf(X=EFV,
            Lnodes  = c(&quot;adherence.1&quot;,&quot;weight.1&quot;,
                        &quot;adherence.2&quot;,&quot;weight.2&quot;,
                        &quot;adherence.3&quot;,&quot;weight.3&quot;,
                        &quot;adherence.4&quot;,&quot;weight.4&quot;),
            Ynodes  = c(&quot;VL.0&quot;,&quot;VL.1&quot;,&quot;VL.2&quot;,&quot;VL.3&quot;,&quot;VL.4&quot;),
            Anodes  = c(&quot;efv.0&quot;,&quot;efv.1&quot;,&quot;efv.2&quot;,&quot;efv.3&quot;,&quot;efv.4&quot;),
            abar=seq(0,10,1)
)
est2
plot(est2)
</code></pre>
<h4 id="calculating-outcome-weights">Calculating outcome weights</h4>
<p>The function $\texttt{calc.weights}$ calculates the outcome weights described in equation (12) of Schomaker et al. (2023). The setup is simple: i) define variables as confounders, outcomes, interventions or censoring indicators; 
ii) choose a method for conditional density estimation, iii) specify one or many values for $c$, to specify how low support regions are defined:</p>
<pre><code class="language-{r}"># Step 1: calculate weights (add baseline variables to Lnodes)
# a) parametric density based
w &lt;- calc.weights(X=EFV, 
                         Lnodes  = c(&quot;sex&quot;, &quot;metabolic&quot;, &quot;log_age&quot;,
                                     &quot;NRTI&quot; ,&quot;weight.0&quot;,
                                     &quot;adherence.1&quot;,&quot;weight.1&quot;,
                                     &quot;adherence.2&quot;,&quot;weight.2&quot;,
                                     &quot;adherence.3&quot;,&quot;weight.3&quot;,
                                     &quot;adherence.4&quot;,&quot;weight.4&quot;),
                         Ynodes  = c(&quot;VL.0&quot;,&quot;VL.1&quot;,&quot;VL.2&quot;,&quot;VL.3&quot;,&quot;VL.4&quot;),
                         Anodes  = c(&quot;efv.0&quot;,&quot;efv.1&quot;,&quot;efv.2&quot;,&quot;efv.3&quot;,&quot;efv.4&quot;),
                         d.method=&quot;binning&quot;, abar=seq(0,10,1),
                         c=c(0.01,0.001)
)
summary(w) # weight summary
# d.method alternatives: parametric density estimation or highly-adaptive LASSO based
# check ?calc.weights for details
</code></pre>
<h4 id="weighted-sequential-g-formula">Weighted sequential $g$-formula</h4>
<p>We can now use the calculated weights in the sequential $g$-formula by using the $\texttt{Yweights}$ option. The estimation algorithm is listed in Table 1 of Schomaker et al. (2023):</p>
<pre><code class="language-{r}"># Step 2: sequential g-formula with outcome weights
est3 &lt;- sgf(X=EFV,
              Lnodes  = c(&quot;adherence.1&quot;,&quot;weight.1&quot;,
                          &quot;adherence.2&quot;,&quot;weight.2&quot;,
                          &quot;adherence.3&quot;,&quot;weight.3&quot;,
                          &quot;adherence.4&quot;,&quot;weight.4&quot;),
              Ynodes  = c(&quot;VL.0&quot;,&quot;VL.1&quot;,&quot;VL.2&quot;,&quot;VL.3&quot;,&quot;VL.4&quot;),
              Anodes  = c(&quot;efv.0&quot;,&quot;efv.1&quot;,&quot;efv.2&quot;,&quot;efv.3&quot;,&quot;efv.4&quot;),
              Yweights = w$`0.01`,
              abar=seq(0,10,1)
)
</code></pre>
<h4 id="super-learning">Super Learning</h4>
<p>The sequential $g$-formula needs models for the iterated nested conditional outcomes. In the case of binary outcome variables (and more than 1 time point) this equates to modeling proportional data as of the second iteration step.
Using a data-adaptive approach, with super learning, is thus a good option. Candidate learners, and screening algorithms, can be easily passed on to the $\texttt{SuperLearner}$ package. Note that user-written learners (as in the example below)
need to be listed in the option $\texttt{SL.export}$ if parallelization is used (thanks to Eric Polley for helping me here!).</p>
<pre><code class="language-{r}"># Realistic setup
# (requires user-written learners which are available upon request)

library(SuperLearner) 
est5 &lt;- sgf(X=EFV,
            Lnodes  = c(&quot;adherence.1&quot;,&quot;weight.1&quot;,
                        &quot;adherence.2&quot;,&quot;weight.2&quot;,
                        &quot;adherence.3&quot;,&quot;weight.3&quot;,
                        &quot;adherence.4&quot;,&quot;weight.4&quot;),
            Ynodes  = c(&quot;VL.0&quot;,&quot;VL.1&quot;,&quot;VL.2&quot;,&quot;VL.3&quot;,&quot;VL.4&quot;),
            Anodes  = c(&quot;efv.0&quot;,&quot;efv.1&quot;,&quot;efv.2&quot;,&quot;efv.3&quot;,&quot;efv.4&quot;),
            Yweights = w$`0.01`,
            SL.library = list(c(&quot;SL.glm&quot;,&quot;screen.glmnet_nVar_1_4_10_150&quot;),
                              c(&quot;SL.mgcv_base&quot;, &quot;screen.cramersv_3&quot;)),
            SL.export = c(&quot;SL.mgcv_base&quot;,&quot;screen.glmnet_nVar_base&quot;,
                          &quot;screen.cramersv_base&quot;,&quot;predict.SL.mgcv&quot;),
            abar=seq(0,10,1), B=200, ncores=7, seed=41188, prog=&quot;C:/temp&quot;,
            cvControl = list(V=2), # SL option
            calc.support=TRUE
)
est5                                    # estimates
est5$SL.weights                         # Super Learner summary
plot(est5, time.points = c(1,5), CI=T)  # plot with CIs
</code></pre>
<h4 id="further-options">Further options</h4>
<p>The weighted sequential $g$-formula approach can also handle survival settings. There are many important subtleties related to the estimation of the conditional densities needed to calculate the outcome weights. It is possible
to customize density estimation with the highly-adaptive LASSO, and pass on many useful options; details will be described in the future manual.</p>
<h3 id="comparison">Comparison</h3>
<p>As a comparsion between the standard and weighted approach have a look at the below figure: in areas of low support (close to 0), the weighted curve is different, but otherwise similar. Details about the interpretation of the weighted curve
can be found at the bottom of Section 3.2.2 in the paper.</p>
<div><img src="/img/CICI_white.jpeg", width=100%></div>
<h3 id="code">Code</h3>
<p><a name="code"></a></p>
<p>The code of this little tutorial is available <a href="/R/example_homepage.R" target="_blank">here</a>.</p>
<p><a name="bottom"></a></p>

    </div>

    



<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/software/">software</a>
  
  <a class="badge badge-light" href="/tags/g-formula/">g-formula</a>
  
  <a class="badge badge-light" href="/tags/causal-inference/">causal inference</a>
  
  <a class="badge badge-light" href="/tags/continuous-interventions/">continuous interventions</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://MichaelSchomaker.github.io/project/cici/&amp;text=CICI" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://MichaelSchomaker.github.io/project/cici/&amp;t=CICI" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=CICI&amp;body=https://MichaelSchomaker.github.io/project/cici/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://MichaelSchomaker.github.io/project/cici/&amp;title=CICI" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=CICI%20https://MichaelSchomaker.github.io/project/cici/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://MichaelSchomaker.github.io/project/cici/&amp;title=CICI" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>













  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/publication/2017-01-01_optimal_timing_of_an/">Optimal timing of antiretroviral treatment initiation in HIV-positive children and adolescents: a multiregional analysis from Southern Africa, West Africa and Europe</a></li>
      
      <li><a href="/publication/2016-01-01_growth_and_mortality/">Growth and Mortality Outcomes for Different Antiretroviral Therapy Initiation Criteria in Children aged 1-5 Years:  A Causal Modelling Analysis from West and Southern Africa</a></li>
      
      <li><a href="/publication/2013-01-01_when_to_start_antire/">When to start antiretroviral therapy in children aged 2-5 years: a collaborative causal modelling analysis of cohort studies from southern Africa</a></li>
      
      <li><a href="/publication/2022-12-21_causal_evidence/">Causal evidence in health decision making: methodological approaches of causal inference and health decision science</a></li>
      
      <li><a href="/publication/2021-03-01_estimating_the_effect/">Estimating the Effect of Central Bank Independence on Inflation Using Longitudinal Targeted Maximum Likelihood Estimation</a></li>
      
    </ul>
  </div>
  



    <div class="project-related-pages content-widget-hr">
      
      

      
      
      

      
      
      
        <h2>Publications</h2>
        
          
            








  
  






<div class="media stream-item">
  <div class="media-body">

    <h3 class="article-title mb-0 mt-0">
      <a href="/publication/2023-05-12_continuous_intervention/" >Causal Inference for Continuous Multiple Time Point Interventions</a>
    </h3>

    

    <div class="stream-meta article-metadata">

      

      
      <div>
        

  
  <span><a>M. Schomaker</a></span>, <span><a>H. McIlleron</a></span>, <span><a>P. Denti</a></span>, <span><a>I. Dìaz</a></span>
      </div>
      
    </div>

    
    <div class="btn-links">
      





  
  
    
  
<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://arxiv.org/abs/2305.06645" target="_blank" rel="noopener">
  Preprint
</a>




  
    
  



<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/pdf/Publication_Schomaker_SIM_2024.pdf" target="_blank" rel="noopener">
  PDF
</a>



<button type="button" class="btn btn-outline-primary my-1 mr-1 btn-sm js-cite-modal"
        data-filename="/publication/2023-05-12_continuous_intervention/cite.bib">
  Cite
</button>


  
  
    
  
<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/zip/Code_Paper_Continuous.zip" target="_blank" rel="noopener">
  Code
</a>




  
  <a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/project/cici/">
    Project
  </a>
  





  
  
    
  
<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/pdf/Presentation_Schomaker_Melbourne_2024.pdf" target="_blank" rel="noopener">
  Slides
</a>







    </div>
    

  </div>
  <div class="ml-3">
    
    
  </div>
</div>

          
        
          
            








  
  






<div class="media stream-item">
  <div class="media-body">

    <h3 class="article-title mb-0 mt-0">
      <a href="/publication/2024_12_03_determining_targets/" >Determining Targets for Antiretroviral Drug Concentrations: a Causal Framework Illustrated with Pediatric Efavirenz Data from the CHAPAS-3 Trial</a>
    </h3>

    

    <div class="stream-meta article-metadata">

      

      
      <div>
        

  
  <span><a>M. Schomaker</a></span>, <span><a>P. Denti</a></span>, <span><a>A. Bienczak</a></span>, <span><a>D. Burger</a></span>, <span><a>I. Diaz</a></span>, <span><a>D. Gibb</a></span>, <span><a>S. Walker</a></span>, <span><a>H. McIlleron</a></span>
      </div>
      
    </div>

    
    <div class="btn-links">
      








  
    
  



<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/pdf/Publication_Schomaker_PDS_2024.pdf" target="_blank" rel="noopener">
  PDF
</a>



<button type="button" class="btn btn-outline-primary my-1 mr-1 btn-sm js-cite-modal"
        data-filename="/publication/2024_12_03_determining_targets/cite.bib">
  Cite
</button>





  
  <a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/project/cici/">
    Project
  </a>
  











    </div>
    

  </div>
  <div class="ml-3">
    
    
  </div>
</div>

          
        
          
            








  
  





  


<div class="media stream-item">
  <div class="media-body">

    <h3 class="article-title mb-0 mt-0">
      <a href="/publication/2018-01-01_bootstrap_inference_/" >Bootstrap inference when using multiple imputation</a>
    </h3>

    
    <div class="article-style">
      For many analyses, it is common to use both bootstrapping and multiple imputation (MI): MI to address missing data and bootstrapping to obtain standard errors. For example, when using the g-formula in causal inference, bootstrapping is required to obtain standard errors; however, the data may be multiply imputed due to missing (baseline) data in the population of interest.
    </div>
    

    <div class="stream-meta article-metadata">

      

      
      <div>
        

  
  <span><a>M. Schomaker</a></span>, <span><a>C. Heumann</a></span>
      </div>
      
    </div>

    
    <div class="btn-links">
      





  
  
    
  
<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/pdf/Preprint_Bootstrap_Schomaker_2018.pdf" target="_blank" rel="noopener">
  Preprint
</a>




  
    
  



<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.7654" target="_blank" rel="noopener">
  PDF
</a>



<button type="button" class="btn btn-outline-primary my-1 mr-1 btn-sm js-cite-modal"
        data-filename="/publication/2018-01-01_bootstrap_inference_/cite.bib">
  Cite
</button>


  
  
    
  
<a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/zip/Code_Paper_Bootstrap_Imputation.zip" target="_blank" rel="noopener">
  Code
</a>




  
  <a class="btn btn-outline-primary my-1 mr-1 btn-sm" href="/project/cici/">
    Project
  </a>
  











    </div>
    

  </div>
  <div class="ml-3">
    
    
    
    <a href="/publication/2018-01-01_bootstrap_inference_/" >
      <img src="/publication/2018-01-01_bootstrap_inference_/featured_hu2d598ae295d090bbf79a809ce5c17186_167025_150x0_resize_q90_lanczos.jpg" alt="">
    </a>
    
  </div>
</div>

          
        
      

      
      
      
    </div>
  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.4aaf2d64e50f8e54cf66dcc54147a22e.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
